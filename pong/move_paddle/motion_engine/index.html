<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.55.6" />
    <meta name="description" content="Documentation for Encompass ECS">
<meta name="author" content="Evan Hemsley">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Motion Engine :: Encompass Docs</title>

    
    <link href="/css/nucleus.css?1561064993" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1561064993" rel="stylesheet">
    <link href="/css/hybrid.css?1561064993" rel="stylesheet">
    <link href="/css/featherlight.min.css?1561064993" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1561064993" rel="stylesheet">
    <link href="/css/auto-complete.css?1561064993" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1561064993" rel="stylesheet">
    <link href="/css/theme.css?1561064993" rel="stylesheet">
    <link href="/css/hugo-theme.css?1561064993" rel="stylesheet">
    <link href="/css/syntax.css?1561064993" rel="stylesheet">
    
      <link href="/css/theme-encompass.css?1561064993" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1561064993"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/pong/move_paddle/motion_engine/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="/index.html"><img src="/images/logo-and-text.png" width="200"></a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1561064993"></script>
<script type="text/javascript" src="/js/auto-complete.js?1561064993"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1561064993"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/why/" title="Why?" class="dd-item 
        
        
        
        ">
      <a href="/why/">
          <b>1. </b>Why?
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/why/the_hard_way/" title="The Hard Way" class="dd-item 
        
        
        
        ">
      <a href="/why/the_hard_way/">
          The Hard Way
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/why/architecture/" title="Architecture" class="dd-item 
        
        
        
        ">
      <a href="/why/architecture/">
          Architecture
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/why/architecture/mess/" title="The Messy Basement" class="dd-item ">
        <a href="/why/architecture/mess/">
        The Messy Basement
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/why/architecture/oop/" title="OOP" class="dd-item ">
        <a href="/why/architecture/oop/">
        OOP
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/why/architecture/ecs/" title="ECS" class="dd-item ">
        <a href="/why/architecture/ecs/">
        ECS
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/why/architecture/hyper_ecs/" title="Hyper ECS" class="dd-item ">
        <a href="/why/architecture/hyper_ecs/">
        Hyper ECS
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/getting_started/" title="Getting Started" class="dd-item 
        
        
        
        ">
      <a href="/getting_started/">
          <b>2. </b>Getting Started
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/getting_started/choosing/" title="Choosing An Engine" class="dd-item ">
        <a href="/getting_started/choosing/">
        Choosing An Engine
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/getting_started/terminal/" title="The Terminal" class="dd-item ">
        <a href="/getting_started/terminal/">
        The Terminal
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/getting_started/editor/" title="The Text Editor" class="dd-item ">
        <a href="/getting_started/editor/">
        The Text Editor
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/getting_started/version_control/" title="Version Control" class="dd-item ">
        <a href="/getting_started/version_control/">
        Version Control
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/getting_started/case_study_love/" title="Case Study: LÖVE" class="dd-item ">
        <a href="/getting_started/case_study_love/">
        Case Study: LÖVE
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/getting_started/project_structure/" title="LÖVE Project Structure" class="dd-item ">
        <a href="/getting_started/project_structure/">
        LÖVE Project Structure
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/concepts/" title="Concepts" class="dd-item 
        
        
        
        ">
      <a href="/concepts/">
          <b>3. </b>Concepts
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/concepts/component/" title="Component" class="dd-item ">
        <a href="/concepts/component/">
        Component
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/concepts/message/" title="Message" class="dd-item ">
        <a href="/concepts/message/">
        Message
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/concepts/entity/" title="Entity" class="dd-item ">
        <a href="/concepts/entity/">
        Entity
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/concepts/engine/" title="Engine" class="dd-item ">
        <a href="/concepts/engine/">
        Engine
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/concepts/renderer/" title="Renderer" class="dd-item ">
        <a href="/concepts/renderer/">
        Renderer
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/concepts/world_builder/" title="World Builder" class="dd-item ">
        <a href="/concepts/world_builder/">
        World Builder
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/concepts/world/" title="World" class="dd-item ">
        <a href="/concepts/world/">
        World
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/pong/" title="Pong" class="dd-item 
        parent
        
        
        ">
      <a href="/pong/">
          <b>4. </b>Pong
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pong/introduction/" title="Intro" class="dd-item ">
        <a href="/pong/introduction/">
        Intro
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pong/draw_paddle/" title="Drawing a Paddle" class="dd-item 
        
        
        
        ">
      <a href="/pong/draw_paddle/">
          Drawing a Paddle
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pong/draw_paddle/canvas_component/" title="Canvas Component" class="dd-item ">
        <a href="/pong/draw_paddle/canvas_component/">
        Canvas Component
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/draw_paddle/position_component/" title="Position Component" class="dd-item ">
        <a href="/pong/draw_paddle/position_component/">
        Position Component
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/draw_paddle/canvas_renderer/" title="Canvas Renderer" class="dd-item ">
        <a href="/pong/draw_paddle/canvas_renderer/">
        Canvas Renderer
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/draw_paddle/initialize_world/" title="Initializing the World" class="dd-item ">
        <a href="/pong/draw_paddle/initialize_world/">
        Initializing the World
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/draw_paddle/first_run/" title="First Run" class="dd-item ">
        <a href="/pong/draw_paddle/first_run/">
        First Run
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pong/move_paddle/" title="Moving the Paddle" class="dd-item 
        parent
        
        
        ">
      <a href="/pong/move_paddle/">
          Moving the Paddle
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pong/move_paddle/motion_engine/" title="Motion Engine" class="dd-item active">
        <a href="/pong/move_paddle/motion_engine/">
        Motion Engine
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/move_paddle/input_handling/" title="Input Handling" class="dd-item ">
        <a href="/pong/move_paddle/input_handling/">
        Input Handling
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/move_paddle/frame_dependence/" title="Frame-Dependence" class="dd-item ">
        <a href="/pong/move_paddle/frame_dependence/">
        Frame-Dependence
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/move_paddle/magic_values/" title="Magic Values" class="dd-item ">
        <a href="/pong/move_paddle/magic_values/">
        Magic Values
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/move_paddle/decoupling/" title="Decoupling" class="dd-item ">
        <a href="/pong/move_paddle/decoupling/">
        Decoupling
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pong/ball/" title="Ball" class="dd-item 
        
        
        
        ">
      <a href="/pong/ball/">
          Ball
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pong/ball/spawning/" title="Spawning" class="dd-item ">
        <a href="/pong/ball/spawning/">
        Spawning
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/ball/moving/" title="Moving" class="dd-item ">
        <a href="/pong/ball/moving/">
        Moving
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pong/ball/bouncing/" title="Bouncing" class="dd-item 
        
        
        
        ">
      <a href="/pong/ball/bouncing/">
          Bouncing
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pong/ball/bouncing/library_integration/" title="Library Integration" class="dd-item ">
        <a href="/pong/ball/bouncing/library_integration/">
        Library Integration
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/ball/bouncing/design/" title="Design" class="dd-item ">
        <a href="/pong/ball/bouncing/design/">
        Design
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/ball/bouncing/motion_engine/" title="Motion Engine: The Revenge" class="dd-item ">
        <a href="/pong/ball/bouncing/motion_engine/">
        Motion Engine: The Revenge
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/ball/bouncing/collision_checking/" title="Collision Checking" class="dd-item ">
        <a href="/pong/ball/bouncing/collision_checking/">
        Collision Checking
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/ball/bouncing/collision_dispatch/" title="Collision Dispatch" class="dd-item ">
        <a href="/pong/ball/bouncing/collision_dispatch/">
        Collision Dispatch
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/ball/bouncing/collision_resolution/" title="Collision Resolution" class="dd-item ">
        <a href="/pong/ball/bouncing/collision_resolution/">
        Collision Resolution
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/ball/bouncing/spawners/" title="Spawners" class="dd-item ">
        <a href="/pong/ball/bouncing/spawners/">
        Spawners
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/ball/bouncing/putting_it_together/" title="Putting It All Together" class="dd-item ">
        <a href="/pong/ball/bouncing/putting_it_together/">
        Putting It All Together
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pong/opponent/" title="The Opponent" class="dd-item 
        
        
        
        ">
      <a href="/pong/opponent/">
          The Opponent
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pong/scoring/" title="Scoring" class="dd-item 
        
        
        
        ">
      <a href="/pong/scoring/">
          Scoring
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pong/scoring/goal_collision/" title="Goal Collision" class="dd-item ">
        <a href="/pong/scoring/goal_collision/">
        Goal Collision
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/scoring/ball_respawn/" title="Ball Respawn" class="dd-item ">
        <a href="/pong/scoring/ball_respawn/">
        Ball Respawn
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/scoring/tracking_score/" title="Tracking the Score" class="dd-item ">
        <a href="/pong/scoring/tracking_score/">
        Tracking the Score
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/scoring/drawing_score/" title="Drawing the Score" class="dd-item ">
        <a href="/pong/scoring/drawing_score/">
        Drawing the Score
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/scoring/center_line/" title="Center Line" class="dd-item ">
        <a href="/pong/scoring/center_line/">
        Center Line
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pong/polish/" title="Finishing Touches" class="dd-item 
        
        
        
        ">
      <a href="/pong/polish/">
          Finishing Touches
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pong/polish/paddle_bounce/" title="Paddle Bounce" class="dd-item ">
        <a href="/pong/polish/paddle_bounce/">
        Paddle Bounce
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/polish/title/" title="Title" class="dd-item ">
        <a href="/pong/polish/title/">
        Title
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pong/polish/win_condition/" title="Win Condition" class="dd-item ">
        <a href="/pong/polish/win_condition/">
        Win Condition
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/pong/conclusion/" title="Conclusion" class="dd-item 
        
        
        
        ">
      <a href="/pong/conclusion/">
          Conclusion
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/notes/" title="Notes" class="dd-item 
        
        
        
        ">
      <a href="/notes/">
          <b>A. </b>Notes
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/notes/api_reference/" title="API Reference" class="dd-item ">
        <a href="/notes/api_reference/">
        API Reference
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/notes/acknowledgments/" title="Acknowledgments" class="dd-item ">
        <a href="/notes/acknowledgments/">
        Acknowledgments
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/notes/license/" title="License" class="dd-item ">
        <a href="/notes/license/">
        License
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Encompass</a> > <a href='/pong/'>Pong</a> > <a href='/pong/move_paddle/'>Moving the Paddle</a> > Motion Engine
          
        
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">

    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Motion Engine
            </h1>
          

        



<p>To create an Engine, we extend the Engine class.</p>

<p>Create a file: <strong>game/engines/motion.ts</strong></p>

<pre><code class="language-ts">import { Engine } from &quot;encompass-ecs&quot;;

export class MotionEngine extends Engine {
    public update(dt: number) {}
}
</code></pre>

<p>Every Engine needs an <em>update</em> method, which optionally takes a <em>delta-time</em> value as a parameter.</p>

<p><em>delta-time</em> is simply the time that has elapsed between the last frame and the current one in seconds. We&rsquo;ll talk more about why this is important in a minute.</p>

<p>Let&rsquo;s think for a minute about what we want this Engine to actually <em>do</em>. Motion is just the change of position over time, right? So our MotionEngine is going to modify PositionComponents based on some amount of movement.</p>

<p>We&rsquo;re gonna need a Message. More specifically, a ComponentMessage.</p>

<p>Create a file: <strong>game/messages/component/motion.ts</strong></p>

<pre><code class="language-ts">import { ComponentMessage, Message } from &quot;encompass-ecs&quot;;
import { PositionComponent } from &quot;game/components/position&quot;;

export class MotionMessage extends Message implements ComponentMessage {
    public component: Readonly&lt;PositionComponent&gt;;
    public x: number;
    public y: number;
}
</code></pre>

<p><em>implements</em> means that the class defines certain required properties or methods. If you don&rsquo;t understand it right now, don&rsquo;t worry, just know that in this case, a Message that <em>implements</em> ComponentMessage needs to have a <em>component</em> property. In our case, a MotionMessage wants to refer to some specific PositionComponent that needs to be updated.</p>

<p><style type="text/css">.notice{padding:18px;line-height:24px;margin-bottom:24px;border-radius:4px;color:#444;background:#e7f2fa}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:#fff;background:#6ab0de}.notice-title:before{margin-right:8px;font-family:&ldquo;Font Awesome 5 Free&rdquo;,FontAwesome;font-weight:400}.notice.warning .notice-title{background:rgba(217,83,79,.9)}.notice.warning .notice-title:before{content:&rsquo;\f071&rsquo;}.notice.warning{background:#fae2e2}.notice.info .notice-title{background:#f0b37e}.notice.info .notice-title:before{content:&rsquo;\f05a&rsquo;}.notice.info{background:#fff2db}.notice.note .notice-title{background:#6ab0de}.notice.note .notice-title:before{content:&rsquo;\f06a&rsquo;}.notice.note{background:#e7f2fA}.notice.tip .notice-title{background:rgba(92,184,92,.8)}.notice.tip .notice-title:before{content:&rsquo;\f058&rsquo;}.notice.tip{background:#e6f9e6}</style><div class="notice warning" >
<p class="first notice-title">Warning</p><p>Why is the component type wrapped in <em>Readonly</em>? You can actually get away with not doing this, but it means you can accidentally get around some of the safety features of Encompass that prevent race conditions. So make sure you do this when defining a ComponentMessage.</p></div></p>

<div class="notice tip" >
<p class="first notice-title">Tip</p><p>Remember before when I said that it is a big no-no to have Components reference each other? Well, it&rsquo;s perfectly fine to have Messages refer to a Component, or even multiple Components.</p>

<p><strong>Don&rsquo;t</strong> ever have a Message that refers to another Message though. That is very bad.</p></div>

<p>Now, how is our MotionEngine going to interact with MotionMessages? It&rsquo;s going to Read them.</p>

<pre><code class="language-ts">import { Engine, Reads } from &quot;encompass-ecs&quot;;
import { MotionMessage } from &quot;game/messages/component/motion&quot;;

@Reads(MotionMessage)
export class MotionEngine extends Engine {
    public update(dt: number) {
        const motion_messages = this.read_messages(MotionMessage);
    }
}
</code></pre>

<p>What happens if we don&rsquo;t declare <strong>@Reads</strong> but still call <em>read_messages</em>? Encompass will yell at us when the game runs, because then it can&rsquo;t guarantee that this Engine runs after Engines which <em>emit</em> MotionMessages, which is no good. We&rsquo;ll talk about Emitting messages soon.</p>

<p>Now we have a reference to all MotionMessages that were emitted this frame. Let&rsquo;s use them to update PositionComponents.</p>

<pre><code class="language-ts">import { Engine, Reads } from &quot;encompass-ecs&quot;;
import { MotionMessage } from &quot;game/messages/component/motion&quot;;

@Reads(MotionMessage)
export class MotionEngine extends Engine {
    public update(dt: number) {
        const motion_messages = this.read_messages(MotionMessage);
        for (const message of motion_messages.values()) {
            const position_component = message.component;
            position_component.x += message.x;
            position_component.y += message.y;
        }
    }
}
</code></pre>

<p>Uh oh. The compiler is yelling at us. &ldquo;Cannot assign to &lsquo;x&rsquo; because it is a read-only property.&rdquo; We&rsquo;re going to need to make the component Mutable.</p>

<p>Mutable is a scary word, but it really just means &ldquo;can have its properties changed.&rdquo; We <em>really</em> don&rsquo;t want two different Engines to be able to change the same Component type, because then we can&rsquo;t be certain about what the final result of the changes will be, and that is an opportunity for horrible nasty bugs to lurk in our game.</p>

<p>So if we&rsquo;re going to be changing PositionComponents, the Engine needs to declare that it Mutates them, and then make the Component mutable.</p>

<pre><code class="language-ts">import { Engine, Mutates, Reads } from &quot;encompass-ecs&quot;;
import { PositionComponent } from &quot;game/components/position&quot;;
import { MotionMessage } from &quot;game/messages/component/motion&quot;;

@Reads(MotionMessage)
@Mutates(PositionComponent)
export class MotionEngine extends Engine {
    public update(dt: number) {
        const motion_messages = this.read_messages(MotionMessage);
        for (const message of motion_messages.values()) {
            const position_component = this.make_mutable(message.component);
            position_component.x += message.x;
            position_component.y += message.y;
        }
    }
}
</code></pre>

<p>Now the compiler is content, and so are we.</p>

<p>Let&rsquo;s add this Engine to our WorldBuilder before we forget.</p>

<p>In <strong>game/game.ts</strong></p>

<pre><code class="language-ts">...

    public load() {
        this.canvas = love.graphics.newCanvas();

        const world_builder = new WorldBuilder();

        // ADD YOUR ENGINES HERE...
        world_builder.add_engine(MotionEngine);

        ...

    }
</code></pre>

<p>Of course, if we run the game now, nothing will happen, because nothing is actually sending out MotionMessages. Let&rsquo;s make that happen.</p>


<footer class=" footline" >
	
</footer>


        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/pong/move_paddle/" title="Moving the Paddle"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/pong/move_paddle/input_handling/" title="Input Handling" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1561064993"></script>
    <script src="/js/perfect-scrollbar.min.js?1561064993"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1561064993"></script>
    <script src="/js/jquery.sticky.js?1561064993"></script>
    <script src="/js/featherlight.min.js?1561064993"></script>
    <script src="/js/html5shiv-printshiv.min.js?1561064993"></script>
    <script src="/js/modernizr.custom-3.6.0.js?1561064993"></script>
    <script src="/js/learn.js?1561064993"></script>
    <script src="/js/hugo-learn.js?1561064993"></script>

    <link href="/mermaid/mermaid.css?1561064993" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1561064993"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <link rel="stylesheet" href="/css/syntax.css">
<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

  </body>
</html>

